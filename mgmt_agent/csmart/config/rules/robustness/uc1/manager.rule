####################################################
# Rule to create Adaptive Robustness management agent
####################################################

#
# OBJS Sensor components
#
sensor_domain              = "org.cougaar.tools.robustness.sensors.SensorDomain"
ping_server_plugin         = "org.cougaar.tools.robustness.sensors.PingServerPlugin"
hb_server_plugin           = "org.cougaar.tools.robustness.sensors.HeartbeatServerPlugin"
hb_requester_plugin        = "org.cougaar.tools.robustness.sensors.HeartbeatRequesterPlugin"
ping_requester_plugin      = "org.cougaar.tools.robustness.sensors.PingRequesterPlugin"

#
# MIC UC1 components
#
ar_servlet                 = "org.cougaar.tools.robustness.ma.ui.ARServlet"
node_health_monitor_plugin = "org.cougaar.tools.robustness.ma.plugins.NodeHealthMonitorPlugin"

# Boeing components
load_balancer_plugin	   ="com.boeing.pw.mct.exnihilo.plugin.EN4JPlugin"

#
# Infrastructure components
#
wp_servlet                 = "org.cougaar.core.wp.WhitePagesServlet"
node_mobility_plugin       = "org.cougaar.core.mobility.service.RootMobilityPlugin"
agent_mobility_plugin      = "org.cougaar.core.mobility.service.RedirectMovePlugin"
communityPlugin            = "org.cougaar.community.CommunityPlugin"
communityViewerServlet     = "org.cougaar.community.util.CommunityViewerServlet"

#
# Create management agents
#
society.each_node do |node|
  # For testing 1AD-SMALL
  if node.name =~ /.*FWD-NODE.*/
    node.add_agent("1AD-SMALL-ARManager")
  end
  # For 1AD-FULL
  if node.name =~ /.*FWD-MGMT-NODE.*/
    node.add_agent("1AD-FWD-ARManager")
  end
  if node.name =~ /.*REAR-MGMT-NODE.*/
    node.add_agent("1AD-REAR-ARManager")
  end
  if node.name =~ /.*CONUS-MGMT-NODE.*/
    node.add_agent("1AD-CONUS-ARManager")
  end
  if node.name =~ /.*TRANS-MGMT-NODE.*/
    node.add_agent("1AD-TRANS-ARManager")
  end
end

#
# Add components for management agents
#
society.each_agent do |agent|
  if agent.name =~ /.*ARManager.*/          # only apply to robustness managers
    agent.add_component do |c|
      c.name = agent.name + "|" + sensor_domain
      c.classname = sensor_domain
      c.priority = "COMPONENT"
      c.insertionpoint = "Node.AgentManager.Agent.DomainManager.Domain"
      c.add_argument("sensors")
    end
    agent.add_component do |c|
      c.classname = communityViewerServlet
    end
    agent.add_component do |c|
      c.classname = ping_server_plugin
    end
    agent.add_component do |c|
      c.classname = hb_server_plugin
    end
    agent.add_component do |c|
      c.classname = agent_mobility_plugin
    end
    agent.add_component do |c|
      c.classname = node_health_monitor_plugin
    end
    agent.add_component do |c|
      c.classname = ar_servlet
    end
    agent.add_component do |c|
      c.classname = ping_requester_plugin
    end
    agent.add_component do |c|
      c.classname = communityPlugin
    end
    agent.add_component do |c|
      c.classname = communityViewerServlet
    end
    agent.add_component do |c|
      c.classname = wp_servlet
      c.add_argument("/wp")
    end
    agent.add_component do |c|
      c.classname = ping_server_plugin
    end
    agent.add_component do |c|
      c.classname = hb_server_plugin
    end
    agent.add_component do |c|
      c.classname = load_balancer_plugin
    end
    agent.add_component do |c|
      c.classname = node_mobility_plugin
    end
  end
end
