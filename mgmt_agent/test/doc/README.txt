###############################################################################

README file for Robustness Management Agent

Date: 11-June-2002

###############################################################################

This readme file contains a brief overview and instructions for running the
ManagementAgent software developed for UltraLog by the Adaptive Robustness
Thread Defense Team.


CONTACT INFO:

  Questions or comments regarding this document or the software included in this
  package should be sent to:

  Ron Snyder
  Mobile Intelligence Corp.
  email: ron@mobile-intelligence.com
  phone: 734-367-0430 x50


OVERVIEW:

  This package includes plugins and supporting classes used in the construction
  of a Management Agent.  A Management Agent is an agent that monitors member
  agents in a specified community and performs corrective action when an
  anomaly is detected.  Current capabilities include the ability to detect
  when an agent has died and to restart that on another node.

  1) HealthMonitorPlugin:  This plugin monitors the health status of all agents
     that are a member of a specified restart community.  At present the health
     status is determined by the receipt of heartbeats that are generated by
     each monitored agent.  When heartbeats are late/missed a ping message is
     sent to the agent to determine if the agent is still active.  If the ping
     fails or if the frequency of late heartbeats exceeds a specified threshold
     the DecisionPlugin is notified.  The HealthMonitorPlugin interacts with
     the following components:

     a) HeartbeatRequesterPlugin:  This plugin is also part of the Management
        Agent and interacts with the HeartbeatServerPlugin in the monitored
        agents to initiate heartbeat generation when requested by the
        HealthMonitorPlugin.  This plugin receives the heartbeats generated
        by the monitored agent and reports conditions that fall out side of
        specified tolerances.

     b) PingRequesterPlugin:  This plugin is part of the Management Agent and
        interacts with the PingServerPlugin in the monitored agents.  Ping
        requests are sent to the PingRequesterPlugin by the HealthMonitorPlugin
        when heartbeats are missed.

  2) DecisionPlugin:  This plugin is responsible for analyzing health anomalies
     detected by the HealthMonitorPlugin and initiating appropriate corrective
     action.  Currently the DecisionPlugin handles two conditions.  The first is
     a subset of what is commonly referred to as Use Case 1 (aka the
     "Sledgehammer").  This is the condition where one or more monitored agents
     have died and must be restarted.  The second condition will be a starting
     point for handling Use Cases 2 & 3.  In these use cases a monitored agent
     is still alive but is operating in a stressed mode due to a
     hardware/network problem or possibly some kind of denial of service attack.
     The current version of the DecisionPlugin does not perform any diagnosis
     or corrective action for UC 2/3.

     a) When an agent has been determined to be non-responsive a restart is
        initiated.  An agent is characterized as non-responsive by the
        HealthMonitorPlugin if heartbeats have ceased and active pings fail.
        In this situation the DecisionPlugin will obtain the hostname of a
        suitable location to restart the agent from the RestartLocatorPlugin.
        The Decision plugin will then publish a request for AgentActionPlugin to
        start the dead agent on the selected host.

     b) The other condition handled by the DecisonPlugin is the situation where
        a monitored agent is still alive but its heartbeats are consistently
        arriving late (or not at all).  This condition represents the first
        level determination of possible UC 2/3 scenario.  Additionaly logic
        will be required here in later versions to perform further analysis
        of available sensor data to determine the specific condition.  At
        present the DecisionPlugin simply decreases a heartbeat sensitivity
        parameter used by the HealthMonitorPlugin.  Over time this has the
        effect of causing the HealthMonitorPlugin to ignore late heartbeats.

  3) RestartLocatorPlugin:  This plugin is responsible for selecting a location
     for an agent restart.  This plugin will eventually interface with (or be
     replaced by) components being developed by the Scalability Defense Thread
     team.  At present this plugin performs a round robin selection of a host
     from a predetermined list of available hosts.  The list of available
     hosts is specified as an plugin argument.


SETUP:

  1) Configuring a restart community.

     Restart communities are defined in the configuration database.  Community
     definitions in the configuration database are used by the Community Service
     to assign an agent to its initial communities during startup.  Cougaar 9.4
     will provide the capability to create/edit community definitions using from
     the CSMART tool.  Prior to that community definitions may be created in an
     XML text file and imported into the database using a utility program.
     Community definitions for the MiniTestConfig and 1AD societies are part
     of this package and are found in file "test/configs/data/communities.xml".
     After editing this XML file the modified configurations can be imported
     into the configuration database by running the ant tool with the target
     "xmltodb".

     > ant xmltodb


  2) Supplying the name of the robustness community to the ManagementAgent.

     The ManagementAgent will monitor all members agents from a specified
     community.  The name of the community to be monitored is provided to the
     ManagementAgent as a parameter to the HealthMonitorPlugin.  The parameter
     is defined by the argument "community=XXX".  The HealthMonitorPlugin will
     use the Community Service to obtain a membership roster for the named
     community and will monitor all active agents in the community.


TESTS:

  1) Using MiniTestConfig and ".ini" files.

    This section describes the steps for running some simple tests using the
    MiniTestConfig society and running from .ini files.

    a) Simple one computer test.  This test uses 4 console windows on a single
       computer.

       Test Setup:
       -----------

       1 - This test is executed using the ant build tool.  If ant has not
           been installed it can be obtained from the jakarta.apache.org website.
           If the test will be run from Windows-2000 or XP, ant version 1.5Beta
           should be used as the combination of java 1.4 and windows-2000/XP
           does not work correctly with ant version 1.4.x.  If Linux is used
           ant 1.4.x is ok.  This ant commands used in this example assume
           that the test is being run from the packages root directory (this is
           the top-level directory with the build.xml file).

       2 - The environment COUGAAR_INSTALL_PATH path must be defined and point
           to a directory containing Cougaar 9.2.2 or later.

       3 - The "lib" subdirectory directory must contain the following
           3 jar files.  All three jar files may be obtained from the
           cvs.ultralog.net web site.  The Robustness_mic_mgmt_agent.jar may
           also be created using the ant "build" target.

           Robustness_objs_sensors.jar
           Robustness_bbn_bbn.jar
           Robustness_mic_mgmt_agent.jar


       4 - Modify supplied alpreg.ini and cougaar.rc files.  The
           directory "test/configs/common" contains alpreg.ini and cougaar.rc
           files with some host/database configurations.  These files are put
           into the cougaar config path by the ant targets used in these tests.
           These files need to be updated to reflect the local
           configuration unless overridded by files in the
           COUGAAR_INSTALL_PATH/configs/common directory.

       5 - If the configuration database has not previously been loaded with
           the test community configurations import the definitions from the
           provided communities.xml file.  Use the ant target "xmltodb".

           > ant xmltodb

       6 - Delete previous persistence files.  These are written to the
           subdirectory tmp/P.  If this directory exists delete it.


       Test Execution:
       ---------------

       1 - In the first console start the ManagementAgent.  Use the ant target
           "manager".

           > ant manager

       2 - In the second console start an empty node to be used as the
           destination for the restarted agent.  Use the ant target "emptynode".

           > ant emptynode

       3 - Start agents 1BDE, 3-69-ARBN and MCCGlobalMode on the node
           MiniNode1.  Use the ant target "mininode1" for this.

           > ant mininode1

       4 - Start agent 3ID on a MiniNode2.  Use the ant target "mininode2".
           This node has persistence enabled with a frequency of 30 seconds.
           Shortly after the 3ID has started you should see a message indicating
           that a persistence snapshot has been created.

           > ant mininode2

       As the minitestconfig agents are started the ManagementAgent should
       print the message "Adding AGENTNAME" indicating that it has detected the
       agent and is sending a HeartbeatRequest.

       5 - After MiniNode2 has printed a message indicating that agent 3ID was
           persisted kill the node by typing CTRL-C in the MiniNode2 console
           window.  Shortly after this the ManagementAgent should print some
           messages to its console indicating that heartbeats are not being
           received from agent 3ID.  A ping will be sent by the ManagementAgent
           to 3ID to confirm its status.  At this point the DecisionPlugin will
           obtain a hostname (localhost for this test) from the
           RestartLocatorPlugin and will initiate a restart of 3ID on the
           EmptyNode using the AgentActionPlugin.

       6 - If all goes well agent 3ID should restart on the EmptyNode.  This
           will be evident by the generation of the dialog boxes used by 3ID.


    b) Multi computer test.  This test uses 2 or more comupters.  While
       various combinations are possible the best setup would be to run the
       ManagerNode, MiniNode1, MiniNode2, and EmptyNode(s) on separate
       computers.  At a minimum MiniNode2 should run alone to simulate the
       loss of a computer.

       Test Setup:
       -----------

       Steps 1 - 6 from one computer test defined in section "a" above.

       7 - Update the test/configs/ma/manager.ini file to include the name
           of the host(s) to be used as a target for an agent restart.  Modify
           the "hosts=" argument used by the RestartLocatorPlugin.  This
           argument takes 1 or more host names separated by a space.

       8 - Verify the the alpreg.ini file references the name of the host that
           will contain the name server.  This should be either the host that
           is running the manager node or the MiniNode1.


       Test Execution:
       ---------------

       1 - Start the ManagementAgent.

           > ant manager

       2 - Start the empty node(s) to be used a destination for the restarted
           agent.  A "-D" argument must be provided to ant to identify the
           host name of the computer.  This name must match one of the names
           specified as an argument to the RestartLocatorPlugin.

           > ant -Dhost=XXXX emptynode

       3 - Start agents 1BDE, 3-69-ARBN and MCCGlobalMode on the node
           MiniNode1.

           > ant mininode1

       4 - Start agent 3ID on a MiniNode2.  This should ideally be on a computer
           without any other nodes.

           > ant mininode2

       5 - After MiniNode2 has printed a message indicating that agent 3ID was
           persisted kill the node by typing CTRL-C in the MiniNode2 console
           window.

       6 - If all goes well agent 3ID should restart on one of the computers
           running an EmptyNode.  If multiple EmptyNodes were started, 3ID can
           be killed in its new location and it will be restarted by the
           ManagementAgent on another computer with an EmptyNode.


  2) Using 1AD society and CSMART.

     ...