<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Adaptive Robustness Use Case 1 (AR-UC1) Setup</title>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
</head>
<body>
<br>
<br>
<h1>Adaptive Robustness Use Case 1 (AR-UC1) Setup<br>
</h1>
This document provides instructions for configuring a Cougaar   
society to  demonstrate/test Adaptive Robustness (AR) Use Case 1
(AR-UC1)    components.   &nbsp;Use Case 1 involves the detection and
restart of agents    that have been  lost due to a computer or node
failure. <br>
<h2>1.&nbsp; REQUIRED SOFTWARE</h2>
<h3>a. &nbsp;Cougaar</h3>
Cougaar version 10 or greater is required.<br>
<h3>b. &nbsp;Adaptive Robustness Overlays<br>
</h3>
Add the following Robustness overlays to the Cougaar installation. 
&nbsp;The zip files containing these overlays can be obtained from the
Ultralog  CVS site <a href="https://cvs.ultralog.net/dist/">https://cvs.ultralog.net/dist/</a>
. &nbsp;<br>
<ol>
  <li>AR_boeing_exnihilo.zip</li>
  <li>AR_objs_common.zip</li>
  <li>AR_objs_sensors.zip</li>
  <li>AR_mic.zip<br>
  </li>
</ol>
After the files have been downloaded unzip them into the top-level
Cougaar  installation directory.<br>
<br>
<h2>2. &nbsp;RUNNING THE SMALL-1AD TEST SOCIETY</h2>
This section defines the steps required to configure and run the
Small-1AD  test society under ACME.&nbsp; This setup is designed to run
a fairly comprehensive UC1 test using a minimal number of
ccomputers.&nbsp; The test involves the use of a 60 agent society
running on 3 computers.&nbsp; All agents are assigned to the same
robustness community.<br>
<h3>a.&nbsp; ACME Files</h3>
The following AR-UC1 specific ACME files are contained in the
AR_mic.zip overlay. <br>
<h4>1)&nbsp; Rules</h4>
The directory $CIP/csmart/config/rules/robustness/uc1 contains 2 rule
files used by ACME to configure a AR-UC1 society.<br>
<ul>
  <li>aruc1.rule&nbsp; -&nbsp; adds the required AR-UC1 components to
all society nodes and agents.</li>
  <li>manager.rule&nbsp; -&nbsp; creates a special manager agent
(ARManager) and adds to REAR-NODE.&nbsp; The ARManager is loaded with
required components.<br>
  </li>
</ul>
<h4>2)&nbsp; Custom Actions and States</h4>
The directory $CIP/csmart/config/lib/robustness/uc1 contains a Ruby
file (aruc1_actions_and_states.rb) defining AR-UC1 specific actions and
states.&nbsp; Of interest is the "Communities Ready" state that can be
used to synchronize actions performed in ACME test scripts.&nbsp; A
"Community Ready" event is generated by the health monitor manager when
all community agents are active.
<h4>3)&nbsp; Scripts</h4>
The directory $CIP/csmart/config/scripts/robustness/uc1 contains a Ruby
script (uc1-small.rb) for running a comprehensive AR-UC1test using the
SMALL-1AD society.&nbsp;&nbsp; This script performs the following
actions:<br>
<ol>
  <li>Start the society on 3 nodes (FWD-NODE, REAR-NODE, TRANS-NODE)<br>
  </li>
  <li>Wait for CommunitiesReady state indicating that all 60 agents are
active</li>
  <li>Kill the TRANS-NODE (contains 7 agents)<br>
  </li>
  <li>Wait for CommunitiesReady state indicating that the killed agents
have been restated and are again active.&nbsp; All 7 agents from
TRANS-NODE should be restarted on FWD-NODE.<br>
  </li>
  <li>Add a new node to the society.&nbsp; This node is added to the
host that initially contained the killed TRANS-NODE.</li>
  <li>Kill the FWD-NODE (Note that this node contains the ARManager
agent).&nbsp; In this test the remaining nodes (NewNode1 and REAR-NODE)
will detect the loss of the manager agent and will elect a temporary
manager.&nbsp; The temporary manager will restart ARManager agent on
NewNode1.&nbsp; Once it has been restarted management responsiblity is
transferred back to ARManager which will then restart the remaining
agents from FWD-NODE.</li>
  <li>Wait for CommunitiesReady state indicating that all agents have
been restarted and are active.</li>
  <li>Add a new node to the society on the host that initially
contained FWD-NODE.</li>
  <li>Start load balancer to reallocate agents across the 3 hosts/nodes
(REAR-NODE, NewNode1, and NewNode2)</li>
  <li>Wait for CommunitiesReady signifying that the agent moves
suggested by the load balancer have been completed.</li>
</ol>
<h4>4)&nbsp; Society config files</h4>
The directory $CIP/operator contains a SMALL-1AD configuration file
(uc1-small-1ad-layout.xml) that defines the allocation of agents to the
3 hosts used for the test.&nbsp; A XXX-hosts.xml file must also be
present in this directory whtich defines the location-specific names
for these hosts.<br>
<h2>3. &nbsp;MODIFYING AR-UC1 ROBUSTNESS PARAMETERS</h2>
The    SMALL-1AD experiment discussed above uses the default parameter
values listed   in the table below.&nbsp; These parameter values are
defined in the communities.xml file.&nbsp; While these are reasonable
values they have not   been optimized for any particular
configuration.&nbsp;&nbsp; The default values may be overridden by
specifying a different value in the communities.xml file.&nbsp; A
parameter specified in a community-level attribute will be applied to
all member agents.&nbsp; A parameter specified at the entity level will
override the associated value defined at the community level.<br>
<br>
<table cellpadding="2" cellspacing="2" border="2" width="90%"
 align="center">
  <caption><br>
  </caption><tbody>
    <tr>
      <th valign="middle" align="center" width="20%"><b>Parameter Name<br>
      </b></th>
      <td valign="middle" align="center" width="15%"><b>Nominal Value</b><br>
      </td>
      <th valign="top" align="center"><b>Description</b><br>
      </th>
    </tr>
    <tr>
      <td valign="top">INITIAL_EXPIRATION</td>
      <td valign="top" align="right">180000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the INITIAL state.&nbsp; The INITIAL state indicates that
an agent has been designated as a member of a robustness community but
its location and status have not yet been confirmed</td>
    </tr>
    <tr>
      <td valign="top">LOCATED_EXPIRATION</td>
      <td valign="top" align="right">120000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the LOCATED state.&nbsp; The LOCATED state indicates that
an agent has been found by a health monitor plugin but has not yet
begun emitting hearbeats.</td>
    </tr>
    <tr>
      <td valign="top">ACTIVE_EXPIRATION</td>
      <td valign="top" align="right">120000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the ACTIVE state.&nbsp; This state indicates that the agent
is operating normally.&nbsp; The state is periodically renewed by the
health monitor plugin associated with the agents node.</td>
    </tr>
    <tr>
      <td valign="top">HEALTH_CHECK_EXPIRATION</td>
      <td valign="top" align="right">240000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the HEALTH_CHECK state. &nbsp; Since this state performs a
ping to determine if an agent is alive, the expiration must be larger
than the PING_TIMEOUT.&nbsp; If not, the a premature expiration could
cause a false indication of a dead agent.&nbsp; A value of -1 (never
expires) could also be used to completely avoid this problem. </td>
    </tr>
    <tr>
      <td valign="top">DEAD_EXPIRATION</td>
      <td valign="top" align="right">30000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the DEAD state. &nbsp; An expiration should not occur while
in this state as agents are immediately transitioned to the RESTART
state.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">RESTART_EXPIRATION</td>
      <td valign="top" align="right">300000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the RESTART state.&nbsp;&nbsp; This determines how long to
wait for a restart to complete before giving up and initiating a
retry.&nbsp; <br>
      </td>
    </tr>
    <tr>
      <td valign="top">FAILED_RESTART_EXPIRATION</td>
      <td valign="top" align="right">30000</td>
      <td valign="top">Defines the timeout period (in milliseconds) for
an agent in the FAILED_RESTART state. &nbsp; An expiration should not
occur while in this state as agents are immediately transitioned to the
HEALTH_CHECK state.</td>
    </tr>
    <tr>
      <td valign="top">MOVE_EXPIRATION</td>
      <td valign="top" align="right">300000</td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">PING_TIMEOUT</td>
      <td valign="top" align="right">120000</td>
      <td valign="top">Defines the ping timeout period (in
milliseconds).</td>
    </tr>
    <tr>
      <td valign="top">HEARTBEAT_REQUEST_TIMEOUT</td>
      <td valign="top" align="right">60000<br>
      </td>
      <td valign="top">Defines the ping timeout period (in
milliseconds).<br>
      </td>
    </tr>
    <tr>
      <td valign="top">HEARTBEAT_FREQUENCY</td>
      <td valign="top" align="right">60000</td>
      <td valign="top">Defines how often a monitored agent will send a
heartbeat message to the node health monitor plugin.&nbsp; Since these
messages are intra-node, a relatively high frequency shouldn't cause
much overhead.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">HEARTBEAT_TIMEOUT</td>
      <td valign="top" align="right">90000<br>
      </td>
      <td valign="top">Defines how long a heartbeat can be late before
a timeout message is generated.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">HEARTBEAT_PCT_OUT_OF_SPEC</td>
      <td valign="top" style="text-align: right;">80<br>
      </td>
      <td valign="top">Defines how long a heartbeat can be late before
a timeout message is generated.</td>
    </tr>
  </tbody>
</table>
<br>
<br>
<br>
</body>
</html>
